---
title: "mrr_project_bio"
author: ""
date: "2025-11-10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Classification of Cancer outcome using Genetic and Clinical data

# Introduction

This project investigates the effect of genetic and clinical variables on the survival outcome of breast cancer patients. The data contains records of more than 1000 breast cancer patients from several research institutions. Clinical data contains patient-related and tumor-related information. Additionally mRNA gene expression data is available for each patient. The gene expression data has been processed to include only the top 5000 most variable genes on the transformed scale (log2(counts + 1)).

We consider that the main outcome variable of interest is **vital_status**, which is defined in clinical data.

## Load data

```{r cars}
load("mrr_bio.Rdata")
library('S4Vectors')
# genetic data: n x p matrix
dim(GeneX) # 1231 x 5000 
str(GeneX)
colnames(GeneX)[1:10] # first 10 names of genes

# clinical data
dim(clinical_data) # 1231 x 24
head(clinical_data)
colnames(clinical_data) # variables

# outcome variable
y = clinical_data$vital_status
table(y)
```
```{r}

```

```{r}
library(glmnet)
set.seed(0)
Gdata$vital_status <- Cdata$vital_status
x <- scale(as.matrix(Gdata[, 1:5000]))
y <- Gdata$vital_status

cv <- cv.glmnet(x, y, family = "binomial", alpha = 1)

lasso <- glmnet(x, y, family = "binomial", alpha = 1, lambda = cv$lambda.min)

coef_lasso <- coef(lasso)

# Extraire les variables non nulles
sig_vars <- rownames(coef_lasso)[coef_lasso[,1] != 0]
sig_vars <- sig_vars[sig_vars != "(Intercept)"]

sig_vars
length(sig_vars)
```

```{r}
yhat = predict(lasso, newx=x, type="response")
yhat_class <- ifelse(yhat > 0.21, 1, 0)
table(y, yhat_class)
```

```{r}
library(pROC)
roc_obj <- roc(y, yhat) 

# Afficher la courbe ROC
plot(roc_obj, col="blue", main="ROC Curve")

# Calculer AUC
auc(roc_obj)

# Trouver le seuil optimal selon le critÃ¨re de Youden
opt <- coords(roc_obj, "best", best.method="youden", ret=c("threshold","sensitivity","specificity"))
print(opt)
```



